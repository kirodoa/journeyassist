<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>NEMT Booking Form</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet"/>
<style>

/* ‚úÖ Force text left-alignment in Flatpickr input on all devices */
input.flatpickr-input {
  text-align: left !important;
  padding-left: 40px !important;
  font-size: 16px !important;
}

/* üß† iOS/Safari fix for placeholder alignment too */
input.flatpickr-input::placeholder {
  text-align: left !important;
  color: #999;
}

/* üîß Ensure no center alignment leaks in */
input[type="text"].flatpickr-input,
.flatpickr-input[readonly] {
  text-align: left !important;
}



/* üõ† Force left-aligned text in date input (Flatpickr) */
.flatpickr-input {
  text-align: left !important;
  padding-left: 38px !important;
}

/* üîß iOS fix to avoid centering on zoom/touch */
input.flatpickr-input {
  text-align: left !important;
  -webkit-text-size-adjust: 100%;
}

/* üîß Android/Webkit fallback */
input[type="text"].flatpickr-input {
  text-align: left !important;
}



/* üö´ Prevent iOS/Android from overriding button & input styles */
button,
input[type="submit"],
input[type="button"],
input[type="reset"] {
  -webkit-appearance: none;
  appearance: none;
  background: #2c3e50;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  font-weight: bold;
  padding: 14px;
  width: 100%;
  cursor: pointer;
}

/* ‚úÖ Normalize dropdown styling on iOS & Android */
select {
  -webkit-appearance: none;
  appearance: none;
  background-color: white;
  border: 1px solid #ccc;
  border-radius: 6px;
  padding: 12px 12px 12px 38px;
  font-size: 16px;
  cursor: pointer;
}

/* üóìÔ∏è Flatpickr date/time override for iOS */
.flatpickr-input {
  -webkit-appearance: none;
  appearance: none;
  background: white;
  border: 1px solid #ccc;
  border-radius: 6px;
  padding: 12px 12px 12px 38px;
  font-size: 16px;
  cursor: pointer;
}

/* üîï Hide native date/calendar UI on mobile if Flatpickr is used */
input[type="date"]::-webkit-calendar-picker-indicator,
input[type="time"]::-webkit-calendar-picker-indicator {
  display: none;
  -webkit-appearance: none;
}

/* üß† Prevent iOS zoom on inputs when tapping */
@media (max-width: 600px) {
  input,
  select,
  textarea {
    font-size: 16px !important;
  }
}


    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      background: linear-gradient(to right, #f0f4f8, #d9e2ec);
    }
    form {
      max-width: 700px;
      margin: auto;
      background: #EAEAEE;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    h2 {
      text-align: center;
      color: #2c3e50;
    }
    label {
      display: block;
      margin-top: 20px;
      font-weight: 600;
      color: #34495e;
    }
    .required {
      color: #e74c3c;
      font-weight: bold;
    }
    .input-icon {
      position: relative;
      margin-top: 10px;
    }
    .input-icon i {
      position: absolute;
      top: 50%;
      left: 12px;
      transform: translateY(-50%);
      color: #555;
      font-size: 1rem;
      pointer-events: none;
    }
    .input-icon input,
    .input-icon select {
      width: 100%;
      padding: 12px 12px 12px 38px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
      min-height: 46px; /* ‚úÖ Uniform height for text & select (date + time) */
    }
    .input-icon textarea {
      width: 100%;
      padding: 12px 12px 12px 38px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    .input-icon input.no-icon,
    .input-icon textarea.no-icon {
      padding-left: 12px;
    }
    input[type="checkbox"],
    input[type="radio"] {
      width: auto;
      margin-right: 10px;
    }
    .checkbox-group label,
    .radio-group label {
      display: flex;
      align-items: center;
      margin-top: 10px;
      font-weight: normal;
    }
    .flatpickr-input {
      cursor: pointer !important;
    }
    button {
      margin-top: 30px;
      width: 100%;
      padding: 12px;
      background-color: #2c3e50;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .small-note {
      font-size: 0.85em;
      color: #888;
      margin-top: 5px;
      display: block;
    }
    @media (max-width: 600px) {
      .flex-responsive {
        flex-direction: column !important;
      }
    }
  
    #pickup_loader, #return_loader {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 12px;
      color: #666;
      min-width: 130px;
      height: 20px;
      display: none;
    }


#pickup_time_container i,
#return_time_container i {
  position: absolute;
  top: 50%;
  left: 12px;
  transform: translateY(-50%);
  color: #555;
  font-size: 1rem;
  pointer-events: none;
  display: block !important;
}
#pickup_time_container select,
#return_time_container select {
  padding-left: 38px !important;
}

    body {
      background: #EAEAEE;
    }

    /* Slide-down animation for conditional sections */
    .slide-toggle {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease, opacity 0.5s ease;
      opacity: 0;
    }
    .slide-toggle.open {
      max-height: 1000px;
      opacity: 1;
    }

    /* Submit button loading overlay */
    #form-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255, 255, 255, 0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      font-weight: bold;
      color: #3A4C68;
    }

    #form-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255, 255, 255, 0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      font-weight: bold;
      color: #3A4C68;
      transition: opacity 0.3s ease;
    }

    #form-overlay.show {
      display: flex !important;
    }

    form {
      background-color: #EAEAEE !important;
    }

form { background-color: #ffffff !important; }
form {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05) !important;
}

@media (max-width: 600px) {
  .input-icon {
    margin-top: 16px;
  }

  .input-icon i {
    font-size: 1rem;
    left: 10px;
  }

  .input-icon input,
  .input-icon select,
  .input-icon textarea {
    padding-left: 36px;
    font-size: 1rem;
  }

  .checkbox-group label,
  .radio-group label {
    font-size: 0.95rem;
  }
}


#pickup_time_container select,
#return_time_container select {
  padding-left: 44px !important;
}

#pickup_time_container i,
#return_time_container i {
  left: 14px;
  font-size: 1.1rem;
}

@media (max-width: 600px) {
  #pickup_time_container select,
  #return_time_container select {
    font-size: 1rem;
    padding-left: 46px !important;
  }

  #pickup_time_container i,
  #return_time_container i {
    font-size: 1rem;
    left: 12px;
  }
}


/* iPhone & narrow mobile refinements */
@media only screen and (max-width: 480px) {
  .input-icon input,
  .input-icon select,
  .input-icon textarea {
    font-size: 16px; /* Prevents zoom on input in iOS Safari */
    padding-left: 46px !important;
  }

  .input-icon i {
    font-size: 1rem;
    left: 10px;
  }

  #pickup_time_container select,
  #return_time_container select {
    font-size: 16px;
    padding-left: 50px !important;
  }

  #pickup_time_container i,
  #return_time_container i {
    font-size: 1rem;
    left: 12px;
  }

  button {
    font-size: 17px;
    padding: 14px;
  }
}


@media only screen and (max-width: 480px) {
  form {
    padding: 20px;
  }

  label {
    font-size: 1rem;
  }

  .input-icon input,
  .input-icon select,
  .input-icon textarea {
    font-size: 16px !important;
    line-height: 1.4;
    padding-left: 48px !important;
  }

  .input-icon i {
    font-size: 1.1rem;
    left: 12px;
  }

  button {
    font-size: 18px !important;
    padding: 16px !important;
    border-radius: 10px;
    margin-top: 24px;
  }

  .radio-group label,
  .checkbox-group label {
    font-size: 1rem;
    line-height: 1.4;
  }
}


@media (max-width: 600px) {
  .pickup-date-time,
  .return-date-time {
    flex-direction: column !important;
    gap: 0 !important;
  }

  .pickup-date-time > div,
  .return-date-time > div {
    width: 100% !important;
  }

  .input-icon input,
  .input-icon select,
  .input-icon textarea {
    width: 100%;
    font-size: 16px !important;
    padding-left: 48px !important;
  }

  .input-icon i {
    left: 12px !important;
  }

  button {
    font-size: 18px !important;
    padding: 16px !important;
    border-radius: 10px;
    margin-top: 28px;
  }
}

/* üéØ Enforce default text color and prevent iOS autofill override */
input.flatpickr-input,
.flatpickr-input[readonly],
#pickup_time,
#return_time,
select {
  color: inherit !important;
  -webkit-text-fill-color: inherit !important; /* Safari autofill fix */
  font-family: inherit !important;
  text-align: left !important;
}

/* üß† Fix placeholder color in iOS */
input.flatpickr-input::placeholder {
  color: inherit !important;
  opacity: 1 !important; /* Ensures it's visible */
}


/* üß≠ Force consistent alignment for date inputs across all devices */
input.flatpickr-input,
.flatpickr-input[readonly] {
  padding-left: 40px !important;
  text-align: left !important;
  vertical-align: middle !important;
  line-height: 1.2 !important;
}

/* üõ† iOS/mobile-specific tweak to prevent override */
@media only screen and (max-width: 600px) {
  input.flatpickr-input {
    padding-left: 40px !important;
    font-size: 16px !important;
    line-height: 1.3 !important;
  }
}


/* ‚úÖ Ensure Flatpickr text stays left-aligned after selection */
.flatpickr-input,
.flatpickr-input[readonly],
.flatpickr-input:valid,
.flatpickr-input:not(:placeholder-shown) {
  text-align: left !important;
  padding-left: 40px !important;
  line-height: 1.4 !important;
  vertical-align: middle !important;
  -webkit-appearance: none !important;
  appearance: none !important;
  color: inherit !important;
}


/* üõ† Prevent input shrinking and layout collapse on iOS */
.flatpickr-input {
  min-width: 100% !important;
  width: 100% !important;
  box-sizing: border-box !important;
}

/* Ensure parent doesn't collapse or shrink unexpectedly */
.input-icon {
  display: block !important;
  width: 100% !important;
  box-sizing: border-box !important;
}


/* ‚ú® Style the altInput used by Flatpickr */
.flatpickr-alt-input {
  text-align: left !important;
  padding-left: 40px !important;
  box-sizing: border-box !important;
  color: inherit !important;
  font-family: inherit !important;
  font-size: 16px !important;
  line-height: 1.3 !important;
  vertical-align: middle !important;
  width: 100% !important;
  -webkit-text-fill-color: inherit !important;
}

/* Simulate placeholder on altInput when empty */
.flatpickr-alt-input:empty::before {
  content: 'MM/DD/YYYY';
  color: #aaa;
}


/* ‚úÖ Simulate placeholder for .flatpickr-alt-input when empty */
.flatpickr-alt-input[placeholder]:not([value])::before {
  content: attr(placeholder);
  color: #aaa;
  position: absolute;
  left: 40px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}


/* üõ† Fix for city/state/zip input padding on mobile */
@media only screen and (max-width: 600px) {
  .input-icon input.no-icon {
    padding-left: 12px !important;
    text-align: left !important;
    font-size: 16px !important;
  }
}

/* Force Flatpickr visible date input to match other field heights, including on iPhone */
.flatpickr-alt-input {
  height: 46px !important;
  min-height: 46px !important;
  padding: 12px 12px 12px 40px !important; /* align text nicely with the icon */
  box-sizing: border-box !important;
  display: block !important;
}

/* Extra safety on small screens */
@media only screen and (max-width: 600px) {
  .flatpickr-alt-input {
    height: 46px !important;
    min-height: 46px !important;
    font-size: 16px !important; /* helps prevent zoom on focus in iOS */
  }
}


/* üß∑ Extra forced left alignment for date text on iOS/Safari */
.input-icon input,
.flatpickr-alt-input,
.flatpickr-input {
  text-align: left !important;
}

/* üß∑ Force internal date/time value text to left in WebKit (iOS Safari) */
input[type="date"]::-webkit-date-and-time-value,
input[type="time"]::-webkit-date-and-time-value {
  text-align: left !important;
}


/* ‚è∞ Force left alignment for time selects to match date inputs */
.input-icon select,
select {
  text-align: left !important;
  text-align-last: left !important;
}

/* Extra safety on small screens (iOS) */
@media only screen and (max-width: 600px) {
  .input-icon select,
  select {
    text-align: left !important;
    text-align-last: left !important;
    font-size: 16px; /* avoid zoom on focus */
  }
}


/* üéØ Uniform left spacing for all icon fields (date + time + others) */
.input-icon input:not(.no-icon),
.input-icon select {
  padding-left: 44px !important; /* shared offset so text lines up with icons uniformly */
}

/* Keep no-icon inputs tight on the left edge */
.input-icon input.no-icon,
.input-icon textarea.no-icon {
  padding-left: 12px !important;
}



/* üñ•Ô∏è Desktop/tablet uniform heights & font for date + time rows */
.pickup-date-time .input-icon input,
.pickup-date-time .input-icon select,
.return-date-time .input-icon input,
.return-date-time .input-icon select {
  height: 48px !important;
  min-height: 48px !important;
  font-size: 16px !important;
  line-height: 1.4 !important;
}
/* FINAL iPhone alignment fix: make date + time text line up */
@media only screen and (max-width: 600px) {
  /* Pickup pair */
  .pickup-date-time .input-icon .flatpickr-alt-input,
  .pickup-date-time #pickup_time,
  /* Return pair */
  .return-date-time .input-icon .flatpickr-alt-input,
  .return-date-time #return_time {
    height: 46px !important;
    min-height: 46px !important;
    padding: 12px 12px 12px 48px !important; /* same left offset for both */
    font-size: 16px !important;
    line-height: 1.4 !important;
    text-align: left !important;
    text-align-last: left !important; /* for <select> on iOS */
  }
}

</style>
</head>
<body><div id="form-overlay" style="display: none;">Submitting...</div>
<form action="https://script.google.com/macros/s/AKfycbxEAJrfQ60yYKh_Lx8Gh07RIoWApydPE5F0DcywQUuGYHA4UsDwHW0VjfnsO6cHoPpx/exec" id="nemt-form" method="POST"><input id="merged_mobility_other" name="mobility_other" type="hidden"/><input id="merged_services_other" name="services_other" type="hidden"/><input id="merged_mobility" name="mobility_type" type="hidden"/><input id="merged_services" name="services" type="hidden"/>
<h2>Request a Journey Assist Transportation</h2><p style="text-align: center; color: #4a5d7a; margin-top: -10px; font-size: 0.95em;">Submit your details to request a safe and reliable non-emergency medical transportation ride.</p>
<!-- Full Name -->
<label>Full Name <span class="required">*</span></label>
<div style="display: flex; gap: 10px;">
<div class="input-icon" style="flex: 1;">
<i class="fas fa-user"></i>
<input name="first_name" placeholder="First Name" required="" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<i class="fas fa-user"></i>
<input name="last_name" placeholder="Last Name" required="" type="text"/>
</div>
</div>
<!-- Phone -->
<label>Phone Number <span class="required">*</span></label>
<div class="input-icon">
<i class="fas fa-phone"></i>
<input name="phone" pattern="\(\d{3}\) \d{3}-\d{4}" placeholder="(000) 000-0000" required="" title="Please enter a valid phone number in the format (123) 456-7890" type="tel"/>
</div>
<small class="small-note">Please enter a valid phone number</small>
<!-- Email -->
<label>Email Address</label>
<div class="input-icon">
<i class="fas fa-envelope"></i>
<input name="email" placeholder="example@example.com" type="email"/>
</div>
<!-- Pickup Address -->
<label>Pick-Up Address <span class="required">*</span></label>
<div class="input-icon">
<i class="fas fa-location-dot"></i>
<input name="pickup_address" placeholder="Street Address" required="" type="text"/>
</div>
<div style="display: flex; gap: 10px; margin-top: 10px;">
<div class="input-icon" style="flex: 1;">
<input class="no-icon" name="pickup_city" placeholder="City" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<input class="no-icon" name="pickup_state" placeholder="State / Province" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<input class="no-icon" name="pickup_zip" placeholder="ZIP / Postal code" type="text"/>
</div>
</div>
<!-- Dropoff Address -->
<label>Drop-Off Address <span class="required">*</span></label>
<div class="input-icon">
<i class="fas fa-location-dot"></i>
<input name="dropoff_address" placeholder="Street Address" required="" type="text"/>
</div>
<div style="display: flex; gap: 10px; margin-top: 10px;">
<div class="input-icon" style="flex: 1;">
<input class="no-icon" name="dropoff_city" placeholder="City" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<input class="no-icon" name="dropoff_state" placeholder="State / Province" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<input class="no-icon" name="dropoff_zip" placeholder="ZIP / Postal code" type="text"/>
</div>
</div>
<!-- Pickup Date & Time -->
<label>Pick-Up Date and Time <span class="required">*</span></label>
<div class="pickup-date-time" style="display: flex; gap: 10px;">
<div class="input-icon" style="flex: 1;">
<i class="fas fa-calendar-alt"></i>
<input id="pickup_date" name="pickup_date" placeholder="MM/DD/YYYY" required="" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<div id="pickup_time_container" style="display: none; position: relative;"><i class="fas fa-clock" id="pickup_time_icon" style=""></i><select id="pickup_time" name="pickup_time" required=""></select></div>
</div>
</div>
<!-- Return Ride -->
<label>Do you need a return ride? <span class="required">*</span></label>
<div class="radio-group">
<label><input name="return_ride" required="" type="radio" value="Yes"/> Yes</label>
<label><input name="return_ride" type="radio" value="No"/> No</label>
</div>
<!-- Return Date & Time -->
<div id="return-time-container" style="display:none; flex-direction: column; gap: 10px; margin-top: 20px;">
<label>Return Pick-Up Date and Time <span class="required">*</span></label>
<div class="return-date-time" style="display: flex; gap: 10px;">
<div class="input-icon" style="flex: 1;">
<i class="fas fa-calendar-alt"></i>
<input id="return_date" name="return_date" placeholder="MM/DD/YYYY" type="text"/>
</div>
<div class="input-icon" style="flex: 1;">
<div id="return_time_container" style="display: none; position: relative;"><i class="fas fa-clock" id="return_time_icon" style=""></i><select id="return_time" name="return_time"></select></div>
</div>
</div>
</div>
<!-- Services -->
<label>Services <span class="required">*</span></label>
<div class="checkbox-group">
<label><input data-group="services" type="checkbox" value="NEMT"/> Non-Emergency Medical Transportation</label>
<label><input data-group="services" type="checkbox" value="Wheelchair"/> Wheelchair-Accessible</label>
<label><input data-group="services" type="checkbox" value="Door-to-Door"/> Door-to-Door Assistance</label>
<label><input data-group="services" type="checkbox" value="Airport"/> Airport/Travel Transfers</label>
<label><input data-group="services" type="checkbox" value="Gurney"/> Non-Emergency Gurney</label>
<label><input data-group="services" type="checkbox" value="Daily Living"/> Daily Living</label>
<label><input data-group="services" type="checkbox" value="Other"/> Other</label>
</div>
<div class="input-icon" id="services-other-wrapper" style="display: none; margin-top: 10px;">
<i class="fas fa-comment-dots"></i>
<input name="services_other" placeholder="Please specify" type="text"/>
</div>
<!-- Facility -->
<label>Facility / Doctor Name <span class="small-note">(optional)</span></label>
<div class="input-icon">
<i class="fas fa-hospital"></i>
<input name="facility" placeholder="Facility / Doctor Name" type="text"/>
</div>
<!-- Mobility -->
<label>Mobility Type <span class="required">*</span></label>
<div class="checkbox-group">
<label><input data-group="mobility_type" type="checkbox" value="Ambulatory"/> Ambulatory</label>
<label><input data-group="mobility_type" type="checkbox" value="Wheelchair"/> Wheelchair</label>
<label><input data-group="mobility_type" type="checkbox" value="Electric Wheelchair"/> Electric Wheelchair</label>
<label><input data-group="mobility_type" type="checkbox" value="Walker"/> Walker</label>
<label><input data-group="mobility_type" type="checkbox" value="Stretcher"/> Stretcher</label>
<label><input data-group="mobility_type" type="checkbox" value="Other"/> Other</label>
</div>
<div class="input-icon" id="mobility-other-wrapper" style="display: none; margin-top: 10px;">
<i class="fas fa-wheelchair"></i>
<input name="mobility_other" placeholder="Please specify" type="text"/>
</div>
<!-- Door Assistance -->
<label>Door-to-Door Assistance Needed? <span class="required">*</span></label>
<div class="radio-group">
<label><input name="door_to_door" required="" type="radio" value="Yes"/> Yes</label>
<label><input name="door_to_door" type="radio" value="No"/> No</label>
</div>
<!-- Caregiver -->
<label>Will a caregiver ride along?</label>
<div class="radio-group">
<label><input name="caregiver" type="radio" value="Yes"/> Yes</label>
<label><input name="caregiver" type="radio" value="No"/> No</label>
</div>
<!-- Contact Method -->
<label>Preferred Contact Method <span class="required">*</span></label>
<div class="radio-group">
<label><input name="contact_method" required="" type="radio" value="Phone"/> Phone</label>
<label><input name="contact_method" type="radio" value="Text"/> Text</label>
<label><input name="contact_method" type="radio" value="Email"/> Email</label>
</div>
<!-- Notes -->
<label>Additional Notes <span class="small-note">(optional)</span></label>
<div class="input-icon">
<textarea class="no-icon" name="notes" placeholder="Enter any additional information..." rows="4"></textarea>
</div>
<!-- Submit -->
<button type="submit">Submit Request</button>
</form><div id="thank_you_message" style="display:none; padding: 25px; text-align:center; background:#f2f2f2; border:1px solid #ccc; color:#3A4C68; border-radius: 10px; margin-top: 25px; font-size: 1.1em;">
<h2 style="color: #3A4C68; margin-bottom: 12px;">Thank You!</h2>
<p style="color: #4a5d7a; font-size: 1.05em; margin-bottom: 10px;">
    We've received your transportation request and our team is reviewing it.
  </p>
<p style="color: #4a5d7a; font-size: 1.05em; margin-bottom: 10px;">
    You can expect a confirmation shortly via your preferred contact method.
  </p>
<p style="color: #4a5d7a; font-size: 1.05em; margin-bottom: 10px;">
    We are committed to providing a <strong style="color: black;">safe</strong>,
    <strong style="color: black;">reliable</strong>, and
    <strong style="color: black;">compassionate</strong> ride experience.
  </p>
<p style="font-size: 1em; margin-top: 20px; color: #555;">
    If you have any urgent questions or changes, please contact our support team directly.
  </p>
</div>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
  function fillTimes(selectId) {
    const select = document.getElementById(selectId);
    select.innerHTML = "";
    const defaultOption = document.createElement("option");
    defaultOption.value = "";
    defaultOption.textContent = "Select Time";
    defaultOption.disabled = true;
    defaultOption.selected = true;
    select.appendChild(defaultOption);
    for (let i = 0; i < 24; i++) {
      const hour = i % 12 === 0 ? 12 : i % 12;
      const period = i < 12 ? 'AM' : 'PM';
      const label = `${hour}:00 ${period}`;
      const opt = document.createElement("option");
      opt.value = label;
      opt.textContent = label;
      select.appendChild(opt);
    }
  }

  function filterPastTimesIfToday(dateObj, selectId) {
    const now = new Date();
    const select = document.getElementById(selectId);
    const currentHour = now.getHours();

    if (
      dateObj.getDate() === now.getDate() &&
      dateObj.getMonth() === now.getMonth() &&
      dateObj.getFullYear() === now.getFullYear()
    ) {
      Array.from(select.options).forEach(option => {
        const rawTime = option.value;
        const [time, period] = rawTime.split(" ");
        let hour = parseInt(time.split(":")[0]);
        if (period === "PM" && hour !== 12) hour += 12;
        if (period === "AM" && hour === 12) hour = 0;

        if (hour < currentHour) {
          option.disabled = true;
          option.style.color = "gray";
          if (!option.textContent.includes("Past")) {
            option.textContent = rawTime + " (Past)";
          }
        }
      });
    }
  }

  function loadAvailableTimes(dateObj, selectId) {
    const timeIcon = document.getElementById(selectId.replace("time", "time_icon"));

    const select = document.getElementById(selectId);
    const loaderEl = document.getElementById(selectId.replace("time", "loader"));

    if (loaderEl) loaderEl.style.display = "block";
    if (timeIcon) timeIcon.style.display = "block";
    select.disabled = true;

    const selectedDate = dateObj.toISOString().split('T')[0];
    const url = "https://script.google.com/macros/s/AKfycbxEAJrfQ60yYKh_Lx8Gh07RIoWApydPE5F0DcywQUuGYHA4UsDwHW0VjfnsO6cHoPpx/exec?date=" + selectedDate;

    fillTimes(selectId);
    filterPastTimesIfToday(dateObj, selectId);

    fetch(url)
      .then(res => res.json())
      .then(data => {
        const booked = data.booked || [];
        booked.forEach(time => {
          const option = Array.from(select.options).find(o => o.value === time);
          if (option) {
            option.disabled = true;
            option.style.color = "red";
            if (!option.textContent.includes("Booked")) {
              option.textContent = option.value + " (Booked)";
            }
          }
        });

        filterPastTimesIfToday(dateObj, selectId);
        if (loaderEl) loaderEl.style.display = "none";
        if (timeIcon) timeIcon.style.display = "none";
        select.disabled = false;
      })
      .catch(err => {
        console.error("Error fetching booked times:", err);
        if (loaderEl) loaderEl.style.display = "none";
        if (timeIcon) timeIcon.style.display = "none";
        select.disabled = false;
        if (timeIcon) timeIcon.style.display = "none";
        filterPastTimesIfToday(dateObj, selectId);
      });
  }

  window.addEventListener("DOMContentLoaded", function () {
    fillTimes("pickup_time");
    fillTimes("return_time");

    
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const returnRideInputs = document.querySelectorAll("input[name='return_ride']");
    const returnTimeContainer = document.getElementById("return-time-container");
    const returnDateInput = document.getElementById("return_date");
    const returnTimeSelect = document.getElementById("return_time");

    function updateReturnSection() {
      const selected = document.querySelector("input[name='return_ride']:checked");
      if (selected && selected.value === "Yes") {
        returnTimeContainer.style.display = "flex";
        returnDateInput.required = true;
        returnTimeSelect.required = true;
      } else {
        returnTimeContainer.style.display = "none";
        returnDateInput.required = false;
        returnTimeSelect.required = false;
      }
    }

    returnRideInputs.forEach(input => {
      input.addEventListener("change", updateReturnSection);
    });

    updateReturnSection();
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const phoneInput = document.querySelector("input[name='phone']");

    phoneInput.addEventListener("input", function (e) {
      let value = e.target.value.replace(/\D/g, "");
      if (value.length > 10) value = value.substring(0, 10);
      const area = value.substring(0, 3);
      const mid = value.substring(3, 6);
      const last = value.substring(6, 10);
      let formatted = "";
      if (value.length > 6) {
        formatted = `(${area}) ${mid}-${last}`;
      } else if (value.length > 3) {
        formatted = `(${area}) ${mid}`;
      } else if (value.length > 0) {
        formatted = `(${area}`;
      }
      e.target.value = formatted;
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const pickupTimeContainer = document.getElementById("pickup_time_container");

    const pickupTimeIcon = document.getElementById("pickup_time_icon");
    const returnTimeIcon = document.getElementById("return_time_icon");

    const returnTimeContainer = document.getElementById("return_time_container");

    





    
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const pickupTimeContainer = document.getElementById("pickup_time_container");
    const pickupTimeIcon = document.getElementById("pickup_time_icon");
    const returnTimeContainer = document.getElementById("return_time_container");
    const returnTimeIcon = document.getElementById("return_time_icon");

    flatpickr("#pickup_date", {
      altInput: true,
      altFormat: "F j, Y",
      dateFormat: "Y-m-d",
      minDate: new Date(),
      allowInput: false,
      onReady: function(selectedDates, dateStr, instance) {
        instance.altInput.setAttribute("placeholder", "MM/DD/YYYY");
      },
      onChange: function(selectedDates) {
        if (selectedDates.length) {
          loadAvailableTimes(selectedDates[0], "pickup_time");
          pickupTimeContainer.style.display = "block";
          pickupTimeIcon.style.display = "block";
        }
      }
    });

    flatpickr("#return_date", {
      altInput: true,
      altFormat: "F j, Y",
      dateFormat: "Y-m-d",
      minDate: new Date(),
      allowInput: false,
      onReady: function(selectedDates, dateStr, instance) {
        instance.altInput.setAttribute("placeholder", "MM/DD/YYYY");
      },
      onChange: function(selectedDates) {
        if (selectedDates.length) {
          loadAvailableTimes(selectedDates[0], "return_time");
          returnTimeContainer.style.display = "block";
          returnTimeIcon.style.display = "block";
        }
      }
    });
  });
</script>
<script>
window.addEventListener("load", function () {
  const checkboxes = document.querySelectorAll("input[data-group='services']");
  const wrapper = document.getElementById("services-other-wrapper");
  if (!wrapper) return;
  const input = wrapper.querySelector("input");

  function updateVisibility() {
    const isOtherChecked = Array.from(checkboxes).some(cb => cb.checked && cb.value === "Other");
    if (isOtherChecked) {
      wrapper.style.setProperty("display", "block", "important");
    } else {
      wrapper.style.setProperty("display", "none", "important");
    }
    if (input) input.required = isOtherChecked;
  }

  checkboxes.forEach(cb => cb.addEventListener("change", updateVisibility));
  updateVisibility();
});
</script>

<script>
window.addEventListener("load", function () {
  function setupOtherToggle(dataGroup, wrapperId) {
    const checkboxes = document.querySelectorAll("input[data-group='" + dataGroup + "']");
    const wrapper = document.getElementById(wrapperId);
    if (!wrapper) return;
    const input = wrapper.querySelector("input");

    function updateVisibility() {
      const isOtherChecked = Array.from(checkboxes).some(cb => cb.checked && cb.value === "Other");
      wrapper.style.setProperty("display", isOtherChecked ? "block" : "none", "important");
      if (input) input.required = isOtherChecked;
    }

    checkboxes.forEach(cb => cb.addEventListener("change", updateVisibility));
    updateVisibility();
  }

  setupOtherToggle("services", "services-other-wrapper");
  setupOtherToggle("mobility_type", "mobility-other-wrapper");
});
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("nemt-form");
    const overlay = document.getElementById("form-overlay");
    const thankYou = document.getElementById("thank_you_message");

    if (!form || !overlay || !thankYou) return;

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      // Use built-in HTML5 validation first
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Show loading overlay
      overlay.style.display = "flex";

      
      // üîπ Collect Services & Mobility values into hidden fields before sending to Google Sheets
      const selectedServices = Array.from(
        document.querySelectorAll("input[data-group='services']:checked")
      ).map(cb => cb.value);

      const selectedMobility = Array.from(
        document.querySelectorAll("input[data-group='mobility_type']:checked")
      ).map(cb => cb.value);

      const servicesOtherInput = document.querySelector("#services-other-wrapper input[name='services_other']");
      const mobilityOtherInput = document.querySelector("#mobility-other-wrapper input[name='mobility_other']");

      const servicesOtherText = servicesOtherInput ? servicesOtherInput.value.trim() : "";
      const mobilityOtherText = mobilityOtherInput ? mobilityOtherInput.value.trim() : "";

      const mergedServices = document.getElementById("merged_services");
      const mergedMobility = document.getElementById("merged_mobility");
      const mergedServicesOther = document.getElementById("merged_services_other");
      const mergedMobilityOther = document.getElementById("merged_mobility_other");

      if (mergedServices) mergedServices.value = selectedServices.join(", ");
      if (mergedMobility) mergedMobility.value = selectedMobility.join(", ");
      if (mergedServicesOther) mergedServicesOther.value = servicesOtherText;
      if (mergedMobilityOther) mergedMobilityOther.value = mobilityOtherText;

const formData = new FormData(form);
      const action = form.getAttribute("action") || "";

      fetch(action, {
        method: "POST",
        body: formData,
        mode: "no-cors"
      })
      .then(function () {
        // On success (or no-cors nominal success), hide form and show thank-you
        overlay.style.display = "none";
        form.style.display = "none";
        thankYou.style.display = "block";

        // Scroll to thank-you message for better UX on mobile
        try {
          window.scrollTo({ top: thankYou.offsetTop - 20, behavior: "smooth" });
        } catch (err) {
          window.scrollTo(0, thankYou.offsetTop - 20);
        }
      })
      .catch(function () {
        // Even if there's a network error, hide overlay and still show a message
        overlay.style.display = "none";
        form.style.display = "none";
        thankYou.style.display = "block";
      });
    });
  });
</script>

</body>
</html>
